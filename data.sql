
-- =====================================================
-- PROJECT: E-Commerce Sales Performance Analysis (DML)
-- Description: Analyze sales data to identify trends,
--              top products, and regional performance
-- Skills Demonstrated: Complex SQL, Joins, Subqueries,
--                      CTEs, Window Functions, Aggregations
-- =====================================================

-- Use Database  ---

USE ECommerceSalesDB;
GO

--==== Insert Data ====--
-- Customers 
INSERT INTO Customers VALUES
(1, 'Rahul Sharma', 'rahul@email.com', 'Mumbai', 'West', '2023-01-15'),
(2, 'Priya Singh', 'priya@email.com', 'Delhi', 'North', '2023-02-20'),
(3, 'Amit Patel', 'amit@email.com', 'Ahmedabad', 'West', '2023-01-10'),
(4, 'Sneha Gupta', 'sneha@email.com', 'Kolkata', 'East', '2023-03-05'),
(5, 'Vikram Reddy', 'vikram@email.com', 'Hyderabad', 'South', '2023-02-28'),
(6, 'Ananya Iyer', 'ananya@email.com', 'Chennai', 'South', '2023-04-12'),
(7, 'Rajesh Kumar', 'rajesh@email.com', 'Bangalore', 'South', '2023-01-22'),
(8, 'Meera Nair', 'meera@email.com', 'Kochi', 'South', '2023-05-08'),
(9, 'Arjun Mehta', 'arjun@email.com', 'Pune', 'West', '2023-03-18'),
(10, 'Divya Sharma', 'divya@email.com', 'Jaipur', 'North', '2023-06-01'),
(11, 'Karan Singh', 'karan@email.com', 'Lucknow', 'North', '2023-04-25'),
(12, 'Pooja Verma', 'pooja@email.com', 'Chandigarh', 'North', '2023-07-14'),
(13, 'Suresh Rao', 'suresh@email.com', 'Vizag', 'South', '2023-02-11'),
(14, 'Neha Kapoor', 'neha@email.com', 'Delhi', 'North', '2023-08-03'),
(15, 'Aditya Joshi', 'aditya@email.com', 'Mumbai', 'West', '2023-05-29'),
(16, 'Ritu Agarwal', 'ritu@email.com', 'Kolkata', 'East', '2023-09-17'),
(17, 'Manoj Tiwari', 'manoj@email.com', 'Patna', 'East', '2023-06-22'),
(18, 'Swati Mishra', 'swati@email.com', 'Bhopal', 'Central', '2023-10-05'),
(19, 'Deepak Negi', 'deepak@email.com', 'Dehradun', 'North', '2023-07-30'),
(20, 'Kavita Rani', 'kavita@email.com', 'Amritsar', 'North', '2023-11-12'),
(21, 'Rohit Saxena', 'rohit@email.com', 'Agra', 'North', '2023-08-19'),
(22, 'Anjali Das', 'anjali@email.com', 'Guwahati', 'East', '2023-12-01'),
(23, 'Vivek Chauhan', 'vivek@email.com', 'Shimla', 'North', '2023-09-08'),
(24, 'Sunita Pillai', 'sunita@email.com', 'Trivandrum', 'South', '2023-10-25'),
(25, 'Gaurav Malhotra', 'gaurav@email.com', 'Noida', 'North', '2024-01-03');
GO
-- View Data --
--SELECT * FROM Customers;
--GO

-- Products
INSERT INTO Products VALUES
(1, 'Laptop Pro 15', 'Electronics', 75000.00, 55000.00),
(2, 'Wireless Mouse', 'Electronics', 1500.00, 800.00),
(3, 'USB-C Hub', 'Electronics', 2500.00, 1200.00),
(4, 'Office Chair', 'Furniture', 12000.00, 7500.00),
(5, 'Standing Desk', 'Furniture', 25000.00, 15000.00),
(6, 'Monitor 27inch', 'Electronics', 22000.00, 14000.00),
(7, 'Keyboard Mechanical', 'Electronics', 5000.00, 2800.00),
(8, 'Webcam HD', 'Electronics', 3500.00, 1800.00),
(9, 'Desk Lamp LED', 'Furniture', 1800.00, 900.00),
(10, 'Notebook Set', 'Stationery', 500.00, 200.00),
(11, 'Pen Premium', 'Stationery', 350.00, 120.00),
(12, 'Headphones BT', 'Electronics', 8000.00, 4500.00),
(13, 'Mouse Pad XL', 'Electronics', 800.00, 300.00),
(14, 'Cable Organizer', 'Accessories', 600.00, 250.00),
(15, 'Laptop Stand', 'Accessories', 2200.00, 1100.00);
GO

--SELECT * FROM Products;
--GO

INSERT INTO Orders VALUES
(1001, 1, '2024-01-05', '2024-01-08', 'Delivered'),
(1002, 2, '2024-01-07', '2024-01-10', 'Delivered'),
(1003, 3, '2024-01-10', '2024-01-14', 'Delivered'),
(1004, 5, '2024-01-12', '2024-01-15', 'Delivered'),
(1005, 7, '2024-01-15', '2024-01-18', 'Delivered'),
(1006, 4, '2024-01-18', '2024-01-22', 'Delivered'),
(1007, 8, '2024-01-20', '2024-01-24', 'Delivered'),
(1008, 10, '2024-01-25', '2024-01-28', 'Delivered'),
(1009, 6, '2024-02-01', '2024-02-04', 'Delivered'),
(1010, 9, '2024-02-05', '2024-02-08', 'Delivered'),
(1011, 11, '2024-02-08', '2024-02-12', 'Delivered'),
(1012, 12, '2024-02-12', '2024-02-15', 'Delivered'),
(1013, 1, '2024-02-15', '2024-02-18', 'Delivered'),
(1014, 14, '2024-02-18', '2024-02-22', 'Delivered'),
(1015, 15, '2024-02-22', '2024-02-25', 'Delivered'),
(1016, 3, '2024-02-25', '2024-02-28', 'Delivered'),
(1017, 16, '2024-03-01', '2024-03-04', 'Delivered'),
(1018, 17, '2024-03-05', '2024-03-08', 'Delivered'),
(1019, 18, '2024-03-08', '2024-03-12', 'Delivered'),
(1020, 2, '2024-03-12', '2024-03-15', 'Delivered'),
(1021, 19, '2024-03-15', '2024-03-18', 'Delivered'),
(1022, 20, '2024-03-18', '2024-03-22', 'Delivered'),
(1023, 21, '2024-03-22', '2024-03-25', 'Delivered'),
(1024, 5, '2024-03-25', '2024-03-28', 'Delivered'),
(1025, 22, '2024-04-01', '2024-04-04', 'Delivered'),
(1026, 23, '2024-04-05', '2024-04-08', 'Delivered'),
(1027, 7, '2024-04-08', '2024-04-12', 'Delivered'),
(1028, 24, '2024-04-12', '2024-04-15', 'Delivered'),
(1029, 25, '2024-04-15', '2024-04-18', 'Delivered'),
(1030, 13, '2024-04-18', '2024-04-22', 'Delivered'),
(1031, 1, '2024-05-01', '2024-05-04', 'Delivered'),
(1032, 4, '2024-05-05', '2024-05-08', 'Delivered'),
(1033, 8, '2024-05-08', '2024-05-12', 'Delivered'),
(1034, 10, '2024-05-12', '2024-05-15', 'Delivered'),
(1035, 6, '2024-05-15', '2024-05-18', 'Delivered'),
(1036, 9, '2024-05-18', '2024-05-22', 'Delivered'),
(1037, 11, '2024-05-22', '2024-05-25', 'Delivered'),
(1038, 14, '2024-05-25', '2024-05-28', 'Delivered'),
(1039, 2, '2024-06-01', '2024-06-04', 'Delivered'),
(1040, 15, '2024-06-05', '2024-06-08', 'Delivered'),
(1041, 3, '2024-06-08', NULL, 'Shipped'),
(1042, 16, '2024-06-10', NULL, 'Shipped'),
(1043, 19, '2024-06-12', NULL, 'Processing'),
(1044, 20, '2024-06-14', NULL, 'Processing'),
(1045, 7, '2024-06-15', NULL, 'Processing'),
(1046, 21, '2024-06-16', NULL, 'Pending'),
(1047, 22, '2024-06-17', NULL, 'Pending'),
(1048, 5, '2024-06-18', NULL, 'Pending'),
(1049, 13, '2024-06-19', NULL, 'Pending'),
(1050, 25, '2024-06-20', NULL, 'Pending');
GO

--SELECT * FROM Orders;
--GO

--OrderDetails
INSERT INTO OrderDetails VALUES
(1, 1001, 1, 1, 0.00), (2, 1001, 2, 2, 0.05),
(3, 1002, 6, 1, 0.00), (4, 1002, 7, 1, 0.10),
(5, 1003, 4, 2, 0.00), (6, 1003, 9, 3, 0.05),
(7, 1004, 1, 1, 0.05), (8, 1004, 12, 1, 0.00),
(9, 1005, 5, 1, 0.00), (10, 1005, 6, 2, 0.10),
(11, 1006, 10, 10, 0.15), (12, 1006, 11, 20, 0.15),
(13, 1007, 8, 2, 0.00), (14, 1007, 13, 2, 0.05),
(15, 1008, 3, 3, 0.00), (16, 1008, 14, 5, 0.10),
(17, 1009, 1, 1, 0.00), (18, 1009, 15, 1, 0.00),
(19, 1010, 7, 2, 0.05), (20, 1010, 2, 3, 0.05),
(21, 1011, 12, 1, 0.00), (22, 1011, 8, 1, 0.00),
(23, 1012, 4, 1, 0.10), (24, 1012, 9, 2, 0.05),
(25, 1013, 6, 1, 0.00), (26, 1013, 3, 2, 0.00),
(27, 1014, 5, 1, 0.05), (28, 1014, 15, 2, 0.00),
(29, 1015, 1, 1, 0.10), (30, 1015, 7, 1, 0.05),
(31, 1016, 10, 15, 0.20), (32, 1016, 11, 30, 0.20),
(33, 1017, 2, 5, 0.10), (34, 1017, 13, 5, 0.10),
(35, 1018, 12, 2, 0.00), (36, 1018, 14, 3, 0.05),
(37, 1019, 8, 1, 0.00), (38, 1019, 3, 1, 0.00),
(39, 1020, 1, 1, 0.05), (40, 1020, 6, 1, 0.05),
(41, 1021, 4, 1, 0.00), (42, 1021, 5, 1, 0.00),
(43, 1022, 9, 4, 0.10), (44, 1022, 10, 20, 0.15),
(45, 1023, 7, 1, 0.00), (46, 1023, 15, 1, 0.00),
(47, 1024, 12, 2, 0.05), (48, 1024, 2, 2, 0.05),
(49, 1025, 1, 1, 0.00), (50, 1025, 8, 1, 0.00),
(51, 1026, 6, 1, 0.00), (52, 1026, 7, 2, 0.10),
(53, 1027, 3, 2, 0.00), (54, 1027, 14, 4, 0.05),
(55, 1028, 5, 1, 0.05), (56, 1028, 4, 1, 0.05),
(57, 1029, 10, 25, 0.20), (58, 1029, 11, 50, 0.25),
(59, 1030, 12, 1, 0.00), (60, 1030, 13, 3, 0.05),
(61, 1031, 1, 1, 0.05), (62, 1031, 2, 1, 0.00),
(63, 1032, 6, 2, 0.10), (64, 1032, 9, 2, 0.05),
(65, 1033, 8, 3, 0.05), (66, 1033, 15, 2, 0.00),
(67, 1034, 7, 2, 0.05), (68, 1034, 3, 1, 0.00),
(69, 1035, 4, 1, 0.00), (70, 1035, 5, 1, 0.00),
(71, 1036, 12, 1, 0.00), (72, 1036, 14, 2, 0.05),
(73, 1037, 1, 1, 0.10), (74, 1037, 13, 2, 0.05),
(75, 1038, 6, 1, 0.05), (76, 1038, 2, 3, 0.10),
(77, 1039, 10, 30, 0.25), (78, 1039, 11, 40, 0.20),
(79, 1040, 8, 2, 0.00), (80, 1040, 7, 1, 0.00),
(81, 1041, 1, 2, 0.05), (82, 1041, 15, 2, 0.05),
(83, 1042, 5, 1, 0.00), (84, 1042, 4, 2, 0.10),
(85, 1043, 12, 3, 0.10), (86, 1043, 3, 2, 0.05),
(87, 1044, 6, 2, 0.05), (88, 1044, 9, 3, 0.05),
(89, 1045, 2, 5, 0.15), (90, 1045, 13, 5, 0.10),
(91, 1046, 1, 1, 0.00), (92, 1046, 7, 2, 0.05),
(93, 1047, 8, 2, 0.00), (94, 1047, 14, 3, 0.05),
(95, 1048, 5, 1, 0.05), (96, 1048, 6, 1, 0.05),
(97, 1049, 10, 20, 0.15), (98, 1049, 11, 25, 0.15),
(99, 1050, 12, 2, 0.05), (100, 1050, 15, 1, 0.00);
GO

--SELECT * FROM OrderDetails;
--GO